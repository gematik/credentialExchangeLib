= Credential Exchange Library for kotlin

== Issuer
Please note that the issuer acts as verifier if he needs additional data from the holder to issue the credential.

[plantuml]
.state diagram issuer
----
@startuml

state c1 <<choice>>

[*] --> Initialized
Initialized --> SendOffer : receive invitation
SendOffer --> WaitForRequest : send offer
SendOffer --> Closed : close
WaitForRequest --> SubmitCredential : receive request
WaitForRequest --> Closed : close
SubmitCredential --> CredentialSubmitted : send credential
SubmitCredential --> HolderVerification : send presentation request
SubmitCredential --> Closed : close
HolderVerification --> SubmitCredential : receive credential
HolderVerification --> Closed : close
CredentialSubmitted --> Closed : close
Closed --> [*]

@enduml
----

== Holder
Please note that the holder should always verify the trustworthiness of the issuer before present credentials. Nevertheless, the step is optional in the credential exchange protocol, because the verification may be provided somewhere else (e.g. client/server authentication on transport layer).

[plantuml]
.state diagram holder
----
@startuml

state c1 <<choice>>

[*] --> WaitForOffer
WaitForOffer --> c1 : Receive Offer
c1 --> WaitForCredential : [Issuer Verification not required]
c1 --> IssuerVerification : [Issuer Verification required]
IssuerVerification : Request Presenation
IssuerVerification : Verify Presenation
IssuerVerification --> IssuerVerification : Receive Presentation
IssuerVerification --> WaitForCredential : Verification Success
IssuerVerification --> [*] : Verification failed
WaitForCredential : Request Credential
WaitForCredential --> [*] : Receive Credential

@enduml
----